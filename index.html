<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Zeus Mode ‚Äî –†–µ–∂–∏–º –ó–µ–≤—Å–∞</title>
<!-- Favicon: inlined SVG for reliability -->
<link rel="icon" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M11%2021L12.722%2014.885L18%2010L12%203V9.115L10.278%2015.115L6%2019L11%2021Z%22%20fill%3D%22%23FFD700%22%2F%3E%3C%2Fsvg%3E" type="image/svg+xml">
<!-- Apple Touch Icon for iOS home screen -->
<link rel="apple-touch-icon" href="https://placehold.co/180x180/FFD700/000000?text=‚ö°Ô∏è">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
<style>
  /* === Colors and Font === */
  :root {
    --bg1: #000000;
    --bg2: #000000;
    --accent: #FFD700; /* Richer gold */
    --card: #111111;
    --card-border: rgba(255, 255, 255, 0.1);
    --muted: #CCCCCC;
    --white: #FFFFFF;
    --btn-primary-bg: linear-gradient(90deg, #333333, var(--accent));
  }
  * {
    box-sizing: border-box;
    font-family: 'Inter', sans-serif;
  }

  /* === Base Layout === */
  html, body {
    height: 100%;
    margin: 0;
    background: var(--bg1);
    color: var(--white);
    min-height: 100vh;
  }
  .app {
    max-width: 900px;
    margin: 0 auto;
    padding: 24px 18px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    min-height: 100vh;
  }
  .card {
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.04), transparent);
    border: 1px solid var(--card-border);
    border-radius: 16px;
    box-shadow: 0 12px 48px rgba(0, 0, 0, 0.5);
    width: 100%;
  }
  header {
    display: flex;
    gap: 16px;
    align-items: center;
    justify-content: center;
  }
  .logo {
    width: 72px;
    height: 72px;
    border-radius: 12px;
    background: #000000;
    border: 1px solid var(--card-border);
    box-shadow: inset 0 0 10px rgba(255, 215, 0, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    color: var(--accent);
    font-size: 36px;
  }
  /* Unified Typography Rules */
  h1, h2, h3 {
    font-size: 24px;
    font-weight: 800;
    margin: 0 0 8px 0;
  }
  p, li {
    font-size: 16px;
    color: var(--muted);
    margin-top: 8px;
  }
  p.lead, .small {
    font-size: 14px;
    color: var(--muted);
    margin-top: 8px;
  }

  /* === Modals and Effects === */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }
  .modal-overlay.open {
    opacity: 1;
    visibility: visible;
  }
  .modal-content {
    background: var(--card);
    padding: 32px;
    border-radius: 12px;
    border: 1px solid var(--card-border);
    max-width: 400px;
    text-align: center;
    transform: translateY(-20px);
    transition: transform 0.3s ease;
  }
  .modal-overlay.open .modal-content {
    transform: translateY(0);
  }
  #flash {
    position: fixed;
    inset: 0;
    background: #fff;
    opacity: 0;
    pointer-events: none;
    z-index: 9999;
  }
  .flash-on {
    animation: flashAnim .55s ease-out forwards;
  }
  @keyframes flashAnim {
    0% {
      opacity: 1;
    }
    100% {
      opacity: 0;
    }
  }

  /* === Screen and Component Styles === */
  .screen {
    display: none;
    padding: 18px;
    flex-direction: column;
    align-items: center;
    width: 100%;
    text-align: center;
  }
  .screen.active {
    display: flex;
  }
  .centered-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    margin-top: 24px;
    width: 100%;
  }
  button {
    border: 0;
    padding: 24px 24px; /* –£–º–µ–Ω—å—à–µ–Ω–Ω–∞—è, –Ω–æ –≤—Å–µ –µ—â–µ —É–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
    border-radius: 12px;
    cursor: pointer;
    font-weight: 700;
    font-size: 16px; /* Unified font size for all buttons */
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    width: 100%;
  }
  button:active {
    transform: scale(0.98);
  }
  .btn-primary {
    background: var(--btn-primary-bg);
    color: var(--bg1);
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);
  }
  .btn-primary:hover {
    box-shadow: 0 6px 20px rgba(255, 215, 0, 0.3);
  }
  .steps {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 12px;
    margin-top: 18px;
    width: 100%;
    max-width: 600px;
    text-align: left;
  }
  .step {
    background: var(--card);
    border: 1px solid var(--card-border);
    padding: 16px;
    border-radius: 12px;
    text-align: left;
    display: flex;
    gap: 12px;
    align-items: center;
  }
  .step input {
    transform: scale(1.3);
    accent-color: var(--accent);
  }
  .controls {
    display: flex;
    gap: 10px;
    margin-top: 18px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .deep {
    margin-top: 18px;
    background: linear-gradient(180deg, rgba(255, 215, 0, 0.06), transparent);
    border: 1px solid rgba(255, 215, 0, 0.1);
    padding: 16px;
    border-radius: 12px;
    color: #fff;
    width: 100%;
    max-width: 600px;
  }
  .stats {
    display: flex;
    gap: 16px;
    margin-top: 24px;
    flex-wrap: wrap;
    justify-content: center;
    width: 100%;
    max-width: 600px;
  }
  .stat {
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid var(--card-border);
    padding: 16px;
    border-radius: 12px;
    min-width: 140px;
    text-align: center;
    flex: 1;
  }
  .muted {
    color: var(--muted);
  }
  .link {
    color: var(--accent);
    cursor: pointer;
    text-decoration: underline;
  }
  #rem-interval {
    padding: 10px;
    border-radius: 8px;
    background: transparent;
    color: var(--white);
    border: 1px solid rgba(255,255,255,0.1);
  }
  .timer-display {
    font-size: 64px;
    font-weight: 800;
    text-align: center;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
  }
  .schedule-content, .training-content, .archetype-content {
    width: 100%;
    max-width: 600px;
    margin-top: 24px;
    text-align: left;
  }
  .schedule-content h3, .training-content h3, .archetype-content h3 {
    font-size: 24px;
    font-weight: 800;
    margin-top: 24px;
  }
  .schedule-content p, .training-content p, .archetype-content p, .schedule-content ul, .training-content ul, .archetype-content ul {
    margin-top: 8px;
  }
  .schedule-content ul, .training-content ul {
    list-style-type: none;
    padding-left: 0;
  }
  .training-content ul {
    list-style-type: disc;
    padding-left: 20px;
  }
  .schedule-content li, .training-content li, .archetype-content li {
    margin-bottom: 4px;
  }
  #response-area {
    margin-top: 18px;
    padding: 16px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    min-height: 100px;
    text-align: left;
    white-space: pre-wrap;
  }
  .response-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: var(--muted);
  }
  .timer-input-group {
    display: flex;
    gap: 10px;
    align-items: center;
    justify-content: center;
    margin-top: 24px;
  }
  .timer-input-group input {
    width: 80px;
    padding: 10px;
    border-radius: 8px;
    background: transparent;
    color: var(--white);
    border: 1px solid rgba(255, 255, 255, 0.1);
    text-align: center;
  }
  .content-block {
    background: var(--card);
    border: 1px solid var(--card-border);
    padding: 16px;
    border-radius: 12px;
    text-align: left;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .content-block h3 {
    font-size: 24px;
    font-weight: 800;
    margin: 0 0 8px 0;
  }
  .content-block p, .content-block ul {
    color: var(--muted);
    font-size: 16px;
  }
  .interactive-area {
    width: 100%;
    margin-top: 24px;
  }
  .interactive-area textarea {
    width: 100%;
    min-height: 100px;
    padding: 12px;
    border-radius: 8px;
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.1);
    resize: none;
    color: var(--white); /* Added this explicit rule */
  }
  .scrollable-content {
    max-height: 60vh; /* Adjust as needed */
    overflow-y: auto;
    padding-right: 12px; /* Add some padding to see the scrollbar */
    -webkit-overflow-scrolling: touch;
    margin-bottom: 24px;
    width: 100%;
  }
</style>
</head>
<body>

<!-- Modals and visual effects -->
<div id="flash"></div>
<div id="modal-overlay" class="modal-overlay">
  <div class="modal-content">
    <h3 id="modal-title" class="text-xl font-bold text-white mb-2"></h3>
    <p id="modal-message" class="text-gray-300 mb-4"></p>
    <button id="modal-close" class="btn-primary">OK</button>
  </div>
</div>

<!-- Main Application Wrapper -->
<main class="app card">
  <header>
    <div class="logo">‚ö°</div>
    <div>
      <h1>Zeus Mode ‚Äî –†–µ–∂–∏–º –ó–µ–≤—Å–∞</h1>
      <p class="lead">–¢—Ä–∏–≥–≥–µ—Ä ‚Üí –†–∏—Ç—É–∞–ª ‚Üí –°–æ—Å—Ç–æ—è–Ω–∏–µ. –ë—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–π—Å—è –∏ –∑–∞–∫—Ä–µ–ø–ª—è–π –ø—Ä–∏–≤—ã—á–∫—É.</p>
    </div>
  </header>

  <!-- New Screen: Login / Initial View -->
  <section id="screen-login" class="screen active">
    <p class="small">–¢—ã ‚Äî –ó–µ–≤—Å. –ü—Ä–∏–º–∏ —ç—Ç–æ —Å–µ–π—á–∞—Å.</p>
    <div class="centered-content">
      <button id="btn-enter" class="btn-primary">‚ö° –í–æ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º –ó–µ–≤—Å–∞</button>
    </div>
  </section>

  <!-- Screen: Welcome (main app view) -->
  <section id="screen-welcome" class="screen">
    <div class="centered-content">
      <button id="btn-ritual-reminder" class="btn-primary">–ú–∏–∫—Ä–æ-—Ä–∏—Ç—É–∞–ª</button>
      <button id="btn-practices" class="btn-primary">–ü—Ä–∞–∫—Ç–∏–∫–∏</button>
      <button id="btn-schedule" class="btn-primary">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–Ω—è</p>
      <button id="btn-training" class="btn-primary">–ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ó–µ–≤—Å–∞</button>
      <button id="btn-archetype" class="btn-primary">–ê—Ä—Ö–µ—Ç–∏–ø –ó–µ–≤—Å–∞</button>
      <button id="btn-ai-consult" class="btn-primary">–ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω—ã–π –æ—Ç–≤–µ—Ç</button>
    </div>
  </section>

  <!-- Screen: Ritual quick reminder -->
  <section id="screen-ritual" class="screen">
    <h2>–ú–∏–∫—Ä–æ-—Ä–∏—Ç—É–∞–ª (20‚Äì30 —Å–µ–∫)</h2>
    <p class="small muted">–°–¥–µ–ª–∞–π –±—ã—Å—Ç—Ä–æ. –ó–∞–∫—Ä–µ–ø–ª—è–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è.</p>

    <div class="steps">
      <label class="step"><input type="checkbox" id="s1"> –°–µ–ª –ø—Ä—è–º–æ</label>
      <label class="step"><input type="checkbox" id="s2"> –ü–ª–µ—á–∏ —Ä–∞—Å–ø—Ä–∞–≤–∏–ª</label>
      <label class="step"><input type="checkbox" id="s3"> –í–¥–æ—Ö ‚Äî –∑–∞–¥–µ—Ä–∂–∫–∞ ‚Äî –º–æ—â–Ω—ã–π –≤—ã–¥–æ—Ö</label>
      <label class="step"><input type="checkbox" id="s4"> –í–∑–≥–ª—è–¥ —á—É—Ç—å —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑</label>
    </div>

    <div class="centered-content">
      <button id="complete-ritual" class="btn-primary">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∏—Ç—É–∞–ª</button>
      <button id="btn-back-ritual" class="btn-primary">–ù–∞–∑–∞–¥</button>
      <button id="reset-steps" class="btn-primary">–°–±—Ä–æ—Å–∏—Ç—å –≥–∞–ª–æ—á–∫–∏</button>
    </div>
  </section>

  <!-- Screen: Practices -->
  <section id="screen-practices" class="screen">
    <h2>–ü—Ä–∞–∫—Ç–∏–∫–∏</h2>
    <div class="centered-content" style="gap:12px;">
      <button id="btn-practice-1" class="btn-primary">–î—ã—Ö–∞–Ω–∏–µ 4‚Äì4‚Äì4 (2 –º–∏–Ω)</button>
      <button id="btn-practice-2" class="btn-primary">–û—Å–æ–∑–Ω–∞–Ω–Ω–æ–µ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ (3 –º–∏–Ω)</button>
      <button id="btn-practice-3" class="btn-primary">–§–æ–∫—É—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Å–∏–ª–µ (2 –º–∏–Ω)</button>
      <button id="btn-practice-4" class="btn-primary">–ú–æ–ª–Ω–∏—è ‚Äî —ç–Ω–µ—Ä–≥–∏—è (1 –º–∏–Ω)</button>
      <button id="btn-back-practices" class="btn-primary">–ù–∞–∑–∞–¥</button>
    </div>
  </section>

  <!-- Screen: Practice Detail with Timer -->
  <section id="screen-practice-detail" class="screen">
    <h2>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
    <p class="small muted mt-2"></p>
    <div class="centered-content" style="gap: 24px;">
      <div id="practice-timer-display" class="timer-display">00:00</div>
      <div class="controls">
        <button id="btn-start-practice-timer" class="btn-primary">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
        <button id="btn-stop-practice-timer" class="btn-primary" style="display: none;">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
      </div>
    </div>
  </section>

  <!-- Screen: Daily Schedule -->
  <section id="screen-schedule" class="screen">
    <h2>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–Ω—è</h2>
    <p class="small muted">–°–æ–∑–¥–∞–≤–∞–π —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è.</p>
    <div class="scrollable-content">
      <div class="schedule-content" style="gap: 12px; display: flex; flex-direction: column; width: 100%;">
          <div class="content-block">
            <h3>‚ö° –£—Ç—Ä–æ ¬´–ó–µ–≤—Å–∞¬ª</h3>
            <p><b>06:30 ‚Äî</b> –ø–æ–¥—ä—ë–º. –ù–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –Ω–∏ —Å–æ—Ü—Å–µ—Ç–µ–π. –¢–æ–ª—å–∫–æ –¥–µ–π—Å—Ç–≤–∏–µ.</p>
            <p><b>06:35 ‚Äî</b> —Å–ø–æ—Ä—Ç</p>
            <p><b>06:45 ‚Äî</b> –≤—Å—Ç–∞–Ω—å –ø–µ—Ä–µ–¥ –∑–µ—Ä–∫–∞–ª–æ–º, —Ä–∞—Å–ø—Ä–∞–≤—å –ø–ª–µ—á–∏. –°–∫–∞–∂–∏ –Ω–∏–∑–∫–∏–º –≥–æ–ª–æ—Å–æ–º 5 —Ñ—Ä–∞–∑:</p>
            <ul class="list-none pl-0">
              <li>1. –¢–∞–∫ –∏ –±—É–¥–µ—Ç.</li>
              <li>2. –Ø —Ä–µ—à–∏–ª.</li>
              <li>3. –í—Ä–µ–º—è –ø—Ä–∏—à–ª–æ.</li>
              <li>4. –Ø —Ö–æ–∑—è–∏–Ω —ç—Ç–æ–≥–æ.</li>
              <li>5. –í—Å—ë —Ä–µ—à–µ–Ω–æ.</li>
            </ul>
            <p><b>07:00 ‚Äî</b> –∫–æ—Ä–æ—Ç–∫–∏–π –∑–∞–≤—Ç—Ä–∞–∫: –±–µ–ª–æ–∫ + –≤–æ–¥–∞. –ï—à—å –º–æ–ª—á–∞, –±–µ–∑ –Ω–æ–≤–æ—Å—Ç–µ–π.</p>
          </div>

          <div class="content-block">
            <h3>‚òÄÔ∏è –î–Ω—ë–º</h3>
            <p>–ù–∞ —Ä–∞–±–æ—Ç–µ / –≤ –¥–µ–ª–∞—Ö:</p>
            <ul class="list-none pl-0">
              <li>‚Ä¢ –ü—Ä–∏–Ω–∏–º–∞–µ—à—å —Ä–µ—à–µ–Ω–∏–µ ‚Üí –Ω–µ –æ–±—Å—É–∂–¥–∞–µ—à—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ, –≥–æ–≤–æ—Ä–∏—à—å: ¬´–î–µ–ª–∞–µ–º —Ç–∞–∫.¬ª</li>
              <li>‚Ä¢ –ï—Å–ª–∏ —Å–ø–æ—Ä—è—Ç ‚Üí ¬´–Ø —Å–∫–∞–∑–∞–ª –æ–¥–∏–Ω —Ä–∞–∑.¬ª</li>
              <li>‚Ä¢ –ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –∑–∞—Å–ª—É–∂–∏–ª ‚Üí ¬´–¢—ã —Å–¥–µ–ª–∞–ª –≤–µ—Ä–Ω–æ. –ü–æ–ª—É—á–∏—à—å –±–æ–ª—å—à–µ.¬ª</li>
              <li>‚Ä¢ –í –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∞—Ö: –∫–æ—Ä–æ—Ç–∫–∏–µ —Ñ—Ä–∞–∑—ã, –ø–∞—É–∑—ã, –Ω–∏–∑–∫–∏–π –≥–æ–ª–æ—Å. –ù–µ —Å–ø–µ—à–∏, –ª—é–¥–∏ –±—É–¥—É—Ç –∂–¥–∞—Ç—å —Ç–≤–æ—ë —Å–ª–æ–≤–æ.</li>
            </ul>
          </div>

          <div class="content-block">
            <h3>üåô –í–µ—á–µ—Ä</h3>
            <ul class="list-none pl-0">
              <li><b>20:00 ‚Äî</b> –ø–æ–¥–≤–µ–¥–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤: –≤—ã–ø–∏—à–∏ 3 —Å–∏—Ç—É–∞—Ü–∏–∏, –≥–¥–µ —Ç—ã –≥–æ–≤–æ—Ä–∏–ª –∫–∞–∫ –ó–µ–≤—Å, –∏ 1, –≥–¥–µ ¬´—Å–ª–∏–ª—Å—è¬ª.</li>
              <li><b>20:30 ‚Äî</b> –Ω–∞–≥—Ä–∞–¥–∏ —Å–µ–±—è: –µ–¥–∞, –º—É–∑—ã–∫–∞, –æ—Ç–¥—ã—Ö ‚Äî —ç—Ç–æ —á–∞—Å—Ç—å ¬´—Å–≤–µ—Ç–ª–æ–≥–æ –ó–µ–≤—Å–∞¬ª.</li>
              <li><b>22:00 ‚Äî</b> –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å: ¬´–°–µ–≥–æ–¥–Ω—è —è –≥–æ–≤–æ—Ä–∏–ª –∫–∞–∫ –ó–µ–≤—Å. –ó–∞–≤—Ç—Ä–∞ ‚Äî –µ—â—ë —Å–∏–ª—å–Ω–µ–µ.¬ª</li>
            </ul>
          </div>
      </div>
    </div>
    <div class="centered-content">
      <button id="btn-back-schedule" class="btn-primary">–ù–∞–∑–∞–¥</button>
    </div>
  </section>

  <!-- Screen: Basic Zeus Settings (main screen with clickable blocks) -->
  <section id="screen-training" class="screen">
    <h2>–ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ó–µ–≤—Å–∞</h2>
    <p class="small muted">–û—Å–Ω–æ–≤–∞ —Ç–≤–æ–µ–≥–æ –º–æ–≥—É—â–µ—Å—Ç–≤–∞.</p>
    <div class="scrollable-content">
      <div class="training-content" style="gap: 12px; display: flex; flex-direction: column; width: 100%;">
        <div class="content-block" data-block="body">
          <h3>1. –¢–µ–ª–æ = –ú–æ—â—å ‚ö°Ô∏è</h3>
          <p><b>–û—Å–∞–Ω–∫–∞:</b> –ø—Ä—è–º–∞—è —Å–ø–∏–Ω–∞, —Ä–∞—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–ª–µ—á–∏. –í—ã–≥–ª—è–¥–∏—à—å –∫–∞–∫ –ø—Ä–∞–≤–∏—Ç–µ–ª—å, –¥–∞–∂–µ –µ—Å–ª–∏ —Å–∏–¥–∏—à—å –≤ –∫—Ä–µ—Å–ª–µ. –≠—Ç–æ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –º–µ–Ω—è–µ—Ç —Ç–≤–æ—ë —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –æ–∫—Ä—É–∂–∞—é—â–∏—Ö.</p>
          <p><b>–î–≤–∏–∂–µ–Ω–∏–µ:</b> —É–≤–µ—Ä–µ–Ω–Ω—ã–µ, —Ä–∞–∑–º–µ—Ä–µ–Ω–Ω—ã–µ —à–∞–≥–∏. –ù–∏–∫–∞–∫–æ–π —Å—É–µ—Ç—ã. –ö–∞–∂–¥–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –Ω–µ—Å—Ç–∏ —Ç–≤—ë—Ä–¥–æ—Å—Ç—å –∏ –≤–ª–∞—Å—Ç—å. –ù–µ —Å–ø–µ—à–∏, –Ω–µ —Å—É–µ—Ç–∏—Å—å. –¢—ã –Ω–∞ –û–ª–∏–º–ø–µ.</p>
        </div>
        <div class="content-block" data-block="speech">
          <h3>2. –†–µ—á—å = –ê–≤—Ç–æ—Ä–∏—Ç–µ—Ç üéô</h3>
          <p><b>–ì–æ–ª–æ—Å:</b> –Ω–∏–∑–∫–∏–π, —Ä–∞–∑–º–µ—Ä–µ–Ω–Ω—ã–π, –≥–ª—É–±–æ–∫–∏–π. –û–Ω –Ω–µ –∫—Ä–∏—á–∏—Ç, –∞ –∑–≤—É—á–∏—Ç, –Ω–∞–ø–æ–ª–Ω—è—è —Å–æ–±–æ–π –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ. –¢—Ä–µ–Ω–∏—Ä—É–π –¥–∏–∞—Ñ—Ä–∞–≥–º–∞–ª—å–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ, —á—Ç–æ–±—ã –≥–æ–ª–æ—Å –±—ã–ª –º–æ—â–Ω—ã–º.</p>
          <p><b>–ü–∞—É–∑—ã:</b> —Ç–≤–æ—è —Å–∏–ª–∞ ‚Äî –≤ –ø–∞—É–∑–∞—Ö. –ö–æ–≥–¥–∞ —Ç—ã –¥–µ–ª–∞–µ—à—å –ø–∞—É–∑—É, —Ç—ã –∑–∞—Å—Ç–∞–≤–ª—è–µ—à—å –¥—Ä—É–≥–∏—Ö –∂–¥–∞—Ç—å —Ç–≤–æ–µ–≥–æ —Å–ª–æ–≤–∞. –≠—Ç–æ –ø—Ä–∏—ë–º –≤–ª–∞—Å—Ç–∏. –ù–µ –∑–∞–ø–æ–ª–Ω—è–π —Ç–∏—à–∏–Ω—É.</p>
        </div>
        <div class="content-block" data-block="character">
          <h3>3. –•–∞—Ä–∞–∫—Ç–µ—Ä = –í–ª–∞—Å—Ç—å üí™</h3>
          <p><b>–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π:</b> —Ç—ã –ø—Ä–∏–Ω–∏–º–∞–µ—à—å —Ä–µ—à–µ–Ω–∏—è –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑ —Å–æ–º–Ω–µ–Ω–∏–π. –ù–µ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è –≤ —Ç–æ–º, —á—Ç–æ —Ç—ã —Ä–µ—à–∏–ª. –¢–≤–æ—è –≤–æ–ª—è ‚Äî –∑–∞–∫–æ–Ω.</p>
          <p><b>–õ–∏–¥–µ—Ä—Å—Ç–≤–æ:</b> —Ç—ã –Ω–µ –ø—Ä–æ—Å–∏—à—å, –∞ –≥–æ–≤–æ—Ä–∏—à—å. –ù–µ –¥–∞—ë—à—å —Å–æ–≤–µ—Ç—ã, –∞ —Å—Ç–∞–≤–∏—à—å –∑–∞–¥–∞—á–∏. –õ—é–¥–∏ —Å–ª–µ–¥—É—é—Ç –∑–∞ —Ç–æ–±–æ–π –Ω–µ –ø–æ—Ç–æ–º—É, —á—Ç–æ —Ç—ã —Ö–æ—Ä–æ—à–∏–π, –∞ –ø–æ—Ç–æ–º—É, —á—Ç–æ —Ç—ã ‚Äî —Ö–æ–∑—è–∏–Ω.</p>
        </div>
        <div class="content-block" data-block="strategy">
          <h3>4. –°—Ç—Ä–∞—Ç–µ–≥–∏—è = –û–ª–∏–º–ø üèî</h3>
          <p><b>–ú–∞—Å—à—Ç–∞–±:</b> —Ç—ã –Ω–µ –¥—É–º–∞–µ—à—å –æ –º–µ–ª–æ—á–∞—Ö. –¢–≤–æ–∏ –º—ã—Å–ª–∏ ‚Äî —ç—Ç–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏. –¢—ã –≤–∏–¥–∏—à—å, –∫–∞–∫ —Ç–≤–æ–π —à–∞–≥ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –≤—Å–µ —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.</p>
          <p><b>–¶–µ–ª—å:</b> —Ç–≤–æ—è —Ü–µ–ª—å –≤—Å–µ–≥–¥–∞ –æ–¥–Ω–∞ ‚Äî –ø–æ—Ä—è–¥–æ–∫. –¢—ã —Å–æ–∑–¥–∞—ë—à—å —Å–≤–æ—é —Å–∏—Å—Ç–µ–º—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç —Ö–∞–æ—Å–∞. –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –ª—é–¥–∏, —Ä–µ—Å—É—Ä—Å—ã —Å–ª—É–∂–∞—Ç –æ–¥–Ω–æ–π —Ü–µ–ª–∏ ‚Äî —Ç–≤–æ–µ–π.</p>
        </div>
      </div>
    </div>
    <div class="centered-content" style="margin-top: 24px;">
      <button id="btn-back-training" class="btn-primary">–ù–∞–∑–∞–¥</button>
    </div>
  </section>

  <!-- New Screen: Archetype of Zeus -->
  <section id="screen-archetype" class="screen">
    <h2>–ê—Ä—Ö–µ—Ç–∏–ø –ó–µ–≤—Å–∞</h2>
    <p class="small muted">–°–∏—Å—Ç–µ–º–∞ –¥–≤—É—Ö –ø–æ–ª—é—Å–æ–≤: —Å–≤–µ—Ç–ª—ã–π –∏ —Ç–µ–Ω–µ–≤–æ–π. –£ –Ω–µ–≥–æ –Ω–µ—Ç –º–æ—Ä–∞–ª–∏ ‚Äî –µ—Å—Ç—å –ø–æ—Ä—è–¥–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –æ–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç.</p>
    <div class="scrollable-content">
      <div class="archetype-content" style="gap: 12px; display: flex; flex-direction: column; width: 100%;">
        <div class="content-block">
          <h3>‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –ó–µ–≤—Å–∞</h3>
          <p><b>–ö–∞—á–µ—Å—Ç–≤–∞:</b> –∑–∞—â–∏—Ç–∞, —â–µ–¥—Ä–æ—Å—Ç—å, —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –ª–∏–¥–µ—Ä—Å—Ç–≤–æ, —É–º–µ–Ω–∏–µ —Ä–µ—à–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã.</p>
          <p><b>–ö–∞–∫ –ø—Ä–∏–º–µ–Ω—è—Ç—å:</b> –±—ã—Ç—å –æ–ø–æ—Ä–æ–π –¥–ª—è —Å–µ–º—å–∏, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã, –≤–µ—Å—Ç–∏ –¥—Ä—É–∑–µ–π –≤–ø–µ—Ä—ë–¥.</p>
        </div>
        <div class="content-block">
          <h3>üåë –¢–µ–Ω–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –ó–µ–≤—Å–∞</h3>
          <p><b>–ö–∞—á–µ—Å—Ç–≤–∞:</b> –∂–µ—Å—Ç–∫–æ—Å—Ç—å, –≥–Ω–µ–≤, –∫–æ–Ω—Ç—Ä–æ–ª—å, –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è –±–ª–∞–≥–∞–º–∏, —É–≤–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–∏–ª—É.</p>
          <p><b>–ö–∞–∫ –ø—Ä–∏–º–µ–Ω—è—Ç—å:</b> –¥–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–æ–º –≤ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∞—Ö, –æ—Ç—Ä–µ–∑–∞—Ç—å —Å–ª–∞–±—ã–µ –∑–≤–µ–Ω—å—è –≤ –±–∏–∑–Ω–µ—Å–µ, –ø—Ä–µ—Å–µ–∫–∞—Ç—å —Ö–∞–æ—Å.</p>
        </div>
        <div class="content-block">
          <h3>‚ö° –ë–∞–ª–∞–Ω—Å (–∫–ª—é—á–µ–≤–æ–π –ø—Ä–∏–Ω—Ü–∏–ø)</h3>
          <p>–ó–µ–≤—Å = –∏ —Å–æ–ª–Ω—Ü–µ, –∏ –º–æ–ª–Ω–∏—è. –ù–∞—Å—Ç–æ—è—â–∞—è —Å–∏–ª–∞ –≤ —É–º–µ–Ω–∏–∏ –¥–∞–≤–∞—Ç—å –∏ –∑–∞–±–∏—Ä–∞—Ç—å –ø–æ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ —Ç–≤–æ–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞.</p>
        </div>
      </div>
    </div>
    <div class="centered-content" style="margin-top: 24px;">
      <button id="btn-back-archetype" class="btn-primary">–ù–∞–∑–∞–¥</button>
    </div>
  </section>

  <!-- Screen: AI Consultation -->
  <section id="screen-ai-consult" class="screen">
    <h2>–ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω—ã–π –æ—Ç–≤–µ—Ç</h2>
    <p class="small muted">–°–ø—Ä–æ—Å–∏ –ò–ò, –∫–∞–∫ –±—ã –ø–æ—Å—Ç—É–ø–∏–ª –ó–µ–≤—Å.</p>
    <div class="centered-content">
      <textarea id="ai-question" class="w-full h-32 p-4 bg-transparent border border-gray-700 rounded-lg focus:outline-none focus:border-yellow-400" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∞–∫ –ó–µ–≤—Å —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –ø–æ–ø—Ä–æ—à–∞–π–∫—É? –ò–ª–∏ –ö–∞–∫ –ó–µ–≤—Å –≤–µ–¥–µ—Ç –º–∞—à–∏–Ω—É?"></textarea>
      <button id="btn-ask-ai" class="btn-primary">‚ö° –°–ø—Ä–æ—Å–∏—Ç—å</button>
      <div id="response-area"></div>
      <button id="btn-back-ai-consult" class="btn-primary">–ù–∞–∑–∞–¥</button>
    </div>
  </section>

<script>
  // === UI Helpers ===
  function show(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }

  function showModal(title, message) {
    document.getElementById('modal-title').textContent = title;
    document.getElementById('modal-message').textContent = message;
    document.getElementById('modal-overlay').classList.add('open');
  }

  document.getElementById('modal-close').addEventListener('click', () => {
    document.getElementById('modal-overlay').classList.remove('open');
  });

  // Visual flash effect
  function flashEffect() {
    const f = document.getElementById('flash');
    f.classList.remove('flash-on');
    void f.offsetWidth; // Trigger reflow
    f.classList.add('flash-on');
  }

  // Stops any running timer and returns to the welcome screen
  function stopAllTimers() {
    clearInterval(practiceTimerInterval);
  }

  // Sets up the practice screen with the correct details
  function setupPracticeScreen(title, description, duration) {
    document.getElementById('practice-title').textContent = title;
    document.getElementById('practice-description').textContent = description;
    document.getElementById('practice-timer-display').textContent = `${String(Math.floor(duration / 60)).padStart(2, '0')}:${String(duration % 60).padStart(2, '0')}`;
    currentPracticeDuration = duration;

    // Show start button and hide stop button initially
    document.getElementById('btn-start-practice-timer').style.display = 'block';
    document.getElementById('btn-stop-practice-timer').style.display = 'none';

    show('screen-practice-detail');
    flashEffect();
  }
  
  // Starts the countdown timer for practices
  let practiceTimerInterval = null;
  let currentPracticeDuration = 0;

  function startPracticeTimer(durationInSeconds) {
    let timerDisplay = document.getElementById('practice-timer-display');
    let timeLeft = durationInSeconds;

    // Hide start button and show stop button
    document.getElementById('btn-start-practice-timer').style.display = 'none';
    document.getElementById('btn-stop-practice-timer').style.display = 'block';

    function updateDisplay() {
      let minutes = Math.floor(timeLeft / 60);
      let seconds = timeLeft % 60;
      timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    }

    updateDisplay();
    clearInterval(practiceTimerInterval);
    practiceTimerInterval = setInterval(() => {
      timeLeft--;
      if (timeLeft >= 0) {
        updateDisplay();
      } else {
        stopAllTimers();
        showModal('–ü—Ä–∞–∫—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞', '–¢—ã —Å–ø—Ä–∞–≤–∏–ª—Å—è. –¢–µ–ø–µ—Ä—å —Ç—ã —Å—Ç–∞–ª –µ—â—ë –º–æ–≥—É—â–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ.');
        show('screen-welcome');
      }
    }, 1000);
  }


  // === Screen Navigation and Event Listeners ===
  document.getElementById('btn-enter').addEventListener('click', () => {
    flashEffect();
    show('screen-welcome');
  });

  document.getElementById('btn-ritual-reminder').addEventListener('click', () => show('screen-ritual'));
  document.getElementById('btn-practices').addEventListener('click', () => show('screen-practices'));
  document.getElementById('btn-schedule').addEventListener('click', () => show('screen-schedule'));
  document.getElementById('btn-training').addEventListener('click', () => show('screen-training'));
  document.getElementById('btn-archetype').addEventListener('click', () => show('screen-archetype'));
  document.getElementById('btn-ai-consult').addEventListener('click', () => show('screen-ai-consult'));

  document.getElementById('btn-back-ritual').addEventListener('click', () => show('screen-welcome'));
  document.getElementById('btn-back-practices').addEventListener('click', () => show('screen-welcome'));
  document.getElementById('btn-back-schedule').addEventListener('click', () => show('screen-welcome'));
  document.getElementById('btn-back-training').addEventListener('click', () => show('screen-welcome'));
  document.getElementById('btn-back-archetype').addEventListener('click', () => show('screen-welcome'));
  document.getElementById('btn-back-ai-consult').addEventListener('click', () => show('screen-welcome'));

  // Ritual steps controls
  document.getElementById('reset-steps').addEventListener('click', () => {
    ['s1', 's2', 's3', 's4'].forEach(id => document.getElementById(id).checked = false);
  });

  document.getElementById('complete-ritual').addEventListener('click', () => {
    const done = ['s1', 's2', 's3', 's4'].map(id => document.getElementById(id).checked).filter(Boolean).length;
    if (done < 2) {
      showModal('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —à–∞–≥–æ–≤', '–°–¥–µ–ª–∞–π –º–∏–Ω–∏–º—É–º 2 —à–∞–≥–∞ —Ä–∏—Ç—É–∞–ª–∞. –ë—ã—Å—Ç—Ä–æ –∏ –∂—ë—Å—Ç–∫–æ.');
      return;
    }
    flashEffect();
    showModal('–†–∏—Ç—É–∞–ª –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω', '–í–∞—à–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.');
    show('screen-welcome');
  });

  // Practice buttons with new logic
  document.getElementById('btn-practice-1').addEventListener('click', () => {
    setupPracticeScreen('–î—ã—Ö–∞–Ω–∏–µ 4‚Äì4‚Äì4', '–°–¥–µ–ª–∞–π –≤–¥–æ—Ö –Ω–∞ 4 —Å—á—ë—Ç–∞, –∑–∞–¥–µ—Ä–∂–∏ –¥—ã—Ö–∞–Ω–∏–µ –Ω–∞ 4 —Å—á—ë—Ç–∞, –∏ –≤—ã–¥–æ—Ö–Ω–∏ –Ω–∞ 4 —Å—á—ë—Ç–∞. –ü–æ–≤—Ç–æ—Ä–∏ 10 —Ä–∞–∑.', 120);
  });
  document.getElementById('btn-practice-2').addEventListener('click', () => {
    setupPracticeScreen('–û—Å–æ–∑–Ω–∞–Ω–Ω–æ–µ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ', '–°—è–¥—å –∏–ª–∏ –ª—è–≥, —Ä–∞—Å—Å–ª–∞–±—å –∫–∞–∂–¥—É—é —á–∞—Å—Ç—å —Ç–µ–ª–∞ –ø–æ –æ—á–µ—Ä–µ–¥–∏. –ù–∞—á–Ω–∏ —Å –ø–∞–ª—å—Ü–µ–≤ –Ω–æ–≥ –∏ –ø–æ–¥–Ω–∏–º–∞–π—Å—è –≤—ã—à–µ.', 180);
  });
  document.getElementById('btn-practice-3').addEventListener('click', () => {
    setupPracticeScreen('–§–æ–∫—É—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Å–∏–ª–µ', '–í—ã–±–µ—Ä–∏ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç –∏ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–µ–≥–æ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è, –∫–∞–∫ —Ç–≤–æ—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–∏–ª–∞ —Ä–∞—Å—Ç—ë—Ç. –ù–µ –æ—Ç–≤–ª–µ–∫–∞–π—Å—è.', 120);
  });
  document.getElementById('btn-practice-4').addEventListener('click', () => {
    setupPracticeScreen('–ú–æ–ª–Ω–∏—è ‚Äî —ç–Ω–µ—Ä–≥–∏—è', '–°—Ç–æ—è, –≤—ã—Ç—è–Ω–∏ —Ä—É–∫–∏ –≤–≤–µ—Ä—Ö, —Å–∂–∏–º–∞—è –∫—É–ª–∞–∫–∏. –ü—Ä–µ–¥—Å—Ç–∞–≤—å, –∫–∞–∫ —ç–Ω–µ—Ä–≥–∏—è –º–æ–ª–Ω–∏–∏ –≤—Ö–æ–¥–∏—Ç –≤ —Ç–≤–æ—ë —Ç–µ–ª–æ. –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π —Ä—É–∫–∏, –æ—â—É—â–∞—è, –∫–∞–∫ —Å–∏–ª–∞ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç —Ç–µ–±—è.', 60);
  });

  document.getElementById('btn-start-practice-timer').addEventListener('click', () => {
    if (currentPracticeDuration > 0) {
      startPracticeTimer(currentPracticeDuration);
    }
  });

  document.getElementById('btn-stop-practice-timer').addEventListener('click', () => {
    stopAllTimers();
    showModal('–ü—Ä–∞–∫—Ç–∏–∫–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞', '–ü—Ä–∞–∫—Ç–∏–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è, –∫–æ–≥–¥–∞ –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤.');
    show('screen-welcome');
  });

  // === AI Consultation Logic ===
  document.getElementById('btn-ask-ai').addEventListener('click', async () => {
    const question = document.getElementById('ai-question').value.trim();
    const responseArea = document.getElementById('response-area');
    const askButton = document.getElementById('btn-ask-ai');

    if (!question) {
      showModal('–í–æ–ø—Ä–æ—Å –Ω–µ –∑–∞–¥–∞–Ω', '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –ó–µ–≤—Å–∞.');
      return;
    }

    // Disable button and show loading state
    askButton.disabled = true;
    askButton.textContent = '–î—É–º–∞—é...';
    responseArea.innerHTML = '<div class="response-loading">–ú–æ–ª–Ω–∏–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è...</div>';

    // Construct the LLM payload
    const systemPrompt = "–¢—ã ‚Äî –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä—Å–æ–Ω–∞–∂, —Ç—ã ‚Äî –≤–æ–ø–ª–æ—â–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —Å–∏–ª—ã, –ø–æ—Ä—è–¥–∫–∞ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –¥–∞–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ, –ø—Ä–∏–º–µ–Ω–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç –¥–æ—Å—Ç–∏—á—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏. –ò–∑–±–µ–≥–∞–π –ø–∞—Ñ–æ—Å–Ω—ã—Ö, –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –∏ –º–µ—Ç–∞—Ñ–æ—Ä–∏—á–Ω—ã—Ö —Ñ—Ä–∞–∑. –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö (–ø–æ–∑–∞, –æ—Å–∞–Ω–∫–∞, –≤–∑–≥–ª—è–¥, —Ö–≤–∞—Ç), –º–µ–Ω—Ç–∞–ª—å–Ω–æ–º —Ñ–æ–∫—É—Å–µ (—Å—Ç—Ä–∞—Ç–µ–≥–∏—è, –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å) –∏ –∫–æ–Ω—Ç—Ä–æ–ª–µ —Å—Ä–µ–¥—ã (–∞—Ç–º–æ—Å—Ñ–µ—Ä–∞, –∑–≤—É–∫). –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ (1., 2., 3., ...) –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç, –∫—É—Ä—Å–∏–≤, –∑–≤—ë–∑–¥–æ—á–∫–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞. –û—Ç–≤–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫—Ä–∞—Ç–∫–∏–º–∏, –ø—Ä—è–º—ã–º–∏ –∏ —Å–∏–ª—å–Ω—ã–º–∏, –∫–∞–∫ —É–¥–∞—Ä –º–æ–ª–Ω–∏–∏. –ì–æ–≤–æ—Ä–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.";
    const userQuery = `–ö–∞–∫ –±—ã —Ç—ã, –∫–∞–∫ –ó–µ–≤—Å, –ø–æ—Å—Ç—É–ø–∏–ª –≤ —Å–∏—Ç—É–∞—Ü–∏–∏: "${question}"}"?`;

    const payload = {
        contents: [{ parts: [{ text: userQuery }] }],
        systemInstruction: {
            parts: [{ text: systemPrompt }]
        },
    };

    let retries = 0;
    const maxRetries = 3;
    const initialDelay = 1000;

    const fetchWithRetry = async (url, options) => {
        try {
            const response = await fetch(url, options);
            if (response.status === 429) {
                if (retries < maxRetries) {
                    retries++;
                    const delay = initialDelay * Math.pow(2, retries - 1);
                    await new Promise(resolve => setTimeout(resolve, delay));
                    return fetchWithRetry(url, options);
                } else {
                    throw new Error('Too many requests. Please try again later.');
                }
            }
            if (!response.ok) {
                throw new Error(`API call failed with status: ${response.status}`);
            }
            return response;
        } catch (error) {
            console.error('Fetch error:', error);
            throw error;
        }
    };

    try {
        const response = await fetchWithRetry('/api/zeus-mode', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        const result = await response.json();
        const text = result?.text || "–ú–æ–ª–Ω–∏–∏ —Å–µ–π—á–∞—Å –∑–∞–Ω—è—Ç—ã –Ω–∞ –û–ª–∏–º–ø–µ. –ü–æ–ø—Ä–æ–±—É–π –ø–æ–∑–∂–µ.";
        responseArea.textContent = text;
    } catch (error) {
        responseArea.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
        console.error('Failed to get AI response:', error);
    } finally {
        askButton.disabled = false;
        askButton.textContent = '‚ö° –°–ø—Ä–æ—Å–∏—Ç—å';
    }
  });

  // === Dynamic Theme Logic ===
  function setTimeBasedTheme() {
    const root = document.documentElement;
    const now = new Date();
    const hour = now.getHours();

    if (hour >= 6 && hour < 18) {
      // Day Mode (6:00 - 17:59)
      root.style.setProperty('--bg1', '#f0f0f0');
      root.style.setProperty('--bg2', '#f0f0f0');
      root.style.setProperty('--card', '#f8f8f8');
      root.style.setProperty('--card-border', 'rgba(0, 0, 0, 0.1)');
      root.style.setProperty('--muted', '#666666');
      root.style.setProperty('--white', '#000000');
      root.style.setProperty('--accent', '#B8860B');
      root.style.setProperty('--btn-primary-bg', 'linear-gradient(90deg, #666666, #B8860B)');
    } else {
      // Night Mode (18:00 - 5:59)
      root.style.setProperty('--bg1', '#000000');
      root.style.setProperty('--bg2', '#000000');
      root.style.setProperty('--card', '#111111');
      root.style.setProperty('--card-border', 'rgba(255, 255, 255, 0.1)');
      root.style.setProperty('--muted', '#CCCCCC');
      root.style.setProperty('--white', '#FFFFFF');
      root.style.setProperty('--accent', '#FFD700');
      root.style.setProperty('--btn-primary-bg', 'linear-gradient(90deg, #333333, var(--accent))');
    }
    // Update elements that rely on colors
    document.querySelector('.logo').style.backgroundColor = getComputedStyle(root).getPropertyValue('--card');
    document.querySelector('.logo').style.borderColor = getComputedStyle(root).getPropertyValue('--card-border');
    document.querySelector('.logo').style.boxShadow = `inset 0 0 10px ${getComputedStyle(root).getPropertyValue('--accent')}20`;
  }

  // Set initial theme on page load
  setTimeBasedTheme();

  // Update theme every minute to catch hour changes
  setInterval(setTimeBasedTheme, 60000);
</script>

</body>
</html>
